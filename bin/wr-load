#!/usr/bin/env bash
# Wrapper for load-env.ps1
#
# Usage:
#   bash/zsh: eval "$(wr-load -Resource myapi -Export bash)"
#   fish:     eval (wr-load -Resource myapi -Export fish)

# macOS-compatible way to resolve the real script path (handles symlinks)
get_real_path() {
    local path="$1"
    while [[ -L "$path" ]]; do
        local dir="$(cd "$(dirname "$path")" && pwd)"
        path="$(readlink "$path")"
        [[ "$path" != /* ]] && path="$dir/$path"
    done
    echo "$(cd "$(dirname "$path")" && pwd)/$(basename "$path")"
}

REAL_SCRIPT="$(get_real_path "${BASH_SOURCE[0]}")"
SCRIPT_DIR="$(dirname "$REAL_SCRIPT")"
PROJECT_ROOT="$(dirname "$SCRIPT_DIR")"
pwsh -NoProfile -ExecutionPolicy Bypass -File "$PROJECT_ROOT/scripts/load-env.ps1" "$@"
